<!doctype html>
<html class="no-js">

	<head>
		<meta charset="UTF-8">

		<title>点豆成兵</title>

		<!--IE Compatibility modes-->
		<meta http-equiv="X-UA-Compatible" content="IE=edge">

		<!--Mobile first-->

		<!-- Bootstrap -->
		<link rel="stylesheet" href="../../css/webcss/bootstrap.min.css">

		<!-- Font Awesome -->
		<link rel="stylesheet" href="../../css/webcss/font-awesome.min.css">

		<!-- Metis core stylesheet -->
		<link rel="stylesheet" href="../../css/webcss/main.css">

		<!-- metisMenu stylesheet -->
		<link rel="stylesheet" href="../../css/webcss/metisMenu.min.css">

		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->

		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->

		<!--[if lt IE 9]>
      <script src="../../js/webjs/html5shiv.js"></script>
      <script src="../../js/webjs/respond.min.js"></script>
      <![endif]-->

		<link rel="stylesheet" href="../../css/webcss/theme.css">
		<link rel="stylesheet" href="../../css/webcss/jasny-bootstrap.min.css">
		<script src="../../js/webjs/less.min.js"></script>

		<!--Modernizr-->
		<script src="../../js/webjs/modernizr.min.js"></script>
		<script src="../../js/webjs/base.js"></script>
	</head>

	<body>
		<div class="bg-dark dk" id="wrap">
			<div id="top" class="bg-dark dk" style="width:100%;height:60px;position:fixed;top:0;left:0;z-index: 999999;">
				<header class="head">
					<div class="search-bar" style="text-align: center;">
						<img style="height:40px;width:103px;" src="../../img/webimg/logo_big.png">
					</div>
					<div class="main-bar" style="">
						<h3><i class="fa fa-book"></i>&nbsp; 微信用户列表</h3>
					</div>
				</header>
			</div>

			<div id="left" class="bg-dark dker" style="width:250px;height:100%;position:fixed;top:60px;left:0;z-index: 999999;">
				<div class="media user-media bg-dark dker">
					<div class="user-media-toggleHover">
						<span class="fa fa-user"></span>
					</div>
					<div class="user-wrapper bg-dark">
						<a class="user-link" href="">
							<img class="media-object img-thumbnail user-img" style="width:64px;height:64px;" alt="User Picture" src="../../img/webimg/qrcode.jpg">
						</a>
						<div class="media-body">
							<h5 class="media-heading">欢迎登录点豆成兵</h5>
							<ul class="list-unstyled user-info">
								<li>Administrator</li>
								<li>最近一次访问 :
									<br>
									<small>
                    <i class="fa fa-calendar"></i>&nbsp;2015-12-31</small>
								</li>
							</ul>
						</div>
					</div>
				</div>

				<!-- #menu -->
				<ul id="menu" class="bg-blue dker">
					<li class="">
						<a href="admin_index.html">
							<i class="fa fa-upload"></i><span class="link-title">&nbsp;添加课程</span>
						</a>
					</li>
					<li class="">
						<a href="class_list.html">
							<i class="fa fa-book"></i><span class="link-title">&nbsp;课程列表</span>
						</a>
					</li>
					<li class="">
						<a href="open_class_banner.html">
							<i class="fa fa-align-justify"></i><span class="link-title">&nbsp;公开课Banner</span>
						</a>
					</li>
					<li class="">
						<a href="live_class_share.html">
							<i class="fa fa-share-alt"></i><span class="link-title">&nbsp;直播课程分享链接</span>
						</a>
					</li>
					<li class="">
						<a href="live_class_apply.html">
							<i class="fa fa-github-alt"></i><span class="link-title">&nbsp;直播课程报名人数统计</span>
						</a>
					</li>
					<li class="">
						<a href="open_class_study_count.html">
							<i class="fa fa fa-beer"></i><span class="link-title">&nbsp;公开课学习人数统计</span>
						</a>
					</li>
					<li class="nav-divider"></li>
					<li class="">
						<a href="user_forward_audit.html">
							<i class="fa fa-legal"></i><span class="link-title">&nbsp;视频广告</span>
						</a>
					</li>
					<li class="nav-divider"></li>
					<li class="">
						<a href="weixin_user_list.html">
							<i class="fa fa-user"></i><span class="link-title">&nbsp;微信用户列表</span>
						</a>
					</li>
					<li class="nav-divider"></li>
					<li class="">
						<a href="live_class_statistic.html">
							<i class="fa fa-align-left"></i><span class="link-title">&nbsp;直播课程统计信息</span>
						</a>
					</li>
					<li class="">
						<a href="user_question_list.html">
							<i class="fa fa-question-circle"></i><span class="link-title">&nbsp;直播课程提问</span>
						</a>
					</li>
					<li class="nav-divider"></li>
					<li>
						<a href="/web/webUserLogout">
							<i class="fa fa-sign-out"></i>
							<span class="link-title">退出</span>
						</a>
					</li>
				</ul>
				<!-- /#menu -->
			</div>
			<!-- /#left -->
			<div id="content" style="margin-left:250px;margin-top:60px;">
				<div class="outer">
					<div class="inner bg-light lter" style="overflow-y: auto;">
						<div class="row">
			              <div class="col-lg-12">
			                <div class="box">
			                  <header>
			                    <div class="icons">
			                      <i class="fa fa-table"></i>
			                    </div>
			                    <h5>微信用户信息列表</h5>
			                  </header>
			                  <div id="collapse4" class="body">
			                    <table id="dataTable" style="white-space:normal;" class="table table-bordered table-condensed table-hover table-striped">
			                      <thead>
			                        <tr>
			                          <th nowrap="nowrap">用户头像</th>
			                          <th nowrap="nowrap">用户OpenID</th>
			                          <th nowrap="nowrap">用户昵称</th>
			                          <th nowrap="nowrap">用户性别</th>
			                          <th nowrap="nowrap">省份</th>
			                          <th nowrap="nowrap">城市</th>
			                          <th nowrap="nowrap">VIP状态</th>
			                        </tr>
			                      </thead>
			                      <tbody id="data_detail">
			                        
			                      </tbody>
			                    </table>
			                  </div>
			                </div>
			              </div>
			            </div><!-- /.row -->
					</div>
					<!-- /.inner -->
				</div>
				<!-- /.outer -->
			</div>
			<!-- /#content -->
		</div>
		<!-- /#wrap -->
		<footer class="Footer bg-dark dker" style="width:100%;height:48px;position:fixed;bottom:0;left:0;z-index: 999999;">
			<p>沪ICP备15002235号-4 | COPYRIGHT &copy; 2014-2015, BANGRONGNETWORKTECH, ALL RIGHTS RESERVED</p>

		</footer>
		<!-- /#footer -->

		<!--jQuery -->
		<script src="../../js/webjs/jquery.min.js"></script>

		<!--Bootstrap -->
		<script src="../../js/webjs/bootstrap.min.js"></script>

		<!-- MetisMenu -->
		<script src="../../js/webjs/metisMenu.min.js"></script>

		<!-- Screenfull -->
		<script src="../../js/webjs/screenfull.min.js"></script>

		<script src="../../js/webjs/jasny-bootstrap.min.js"></script>

		<!-- Metis core scripts -->
		<script src="../../js/webjs/core.min.js"></script>

		<!-- Metis demo scripts -->
		<script src="../../js/webjs/app.js"></script>
		<script>
			$('.outer').height($('#left').height() - 48 - 61 - 19);
			$('.inner').height($('#left').height() - 48 - 61 - 20 - 20);
			$(window).resize(function() {
				$('.outer').height($('#left').height() - 48 - 61 - 19);
				$('.inner').height($('#left').height() - 48 - 61 - 20 - 20);
			});
			function checkJsonIsEmpty(json) {
				var isEmpty = true;
				if (json == null) return true;
				for (var jsonKey in json) {
					isEmpty = false;
					break;
				}
				return isEmpty;
			}
			function createDataList(data) {
				var detailNode = document.getElementById('data_detail');
				for (var i in data) {
					var user_sex = data[i].user_sex;
					var vip = data[i].user_type;
					if(vip == "1") {
						vip = "月会员";
					} else if(vip == "2") {
						vip = "季会员";
					} else if(vip == "3"){
						vip = "年会员";
					}
					if(user_sex == 1) {
						user_sex = "男";
					}else if(user_sex == 2){
						user_sex = "女";
					}else {
						user_sex = "未知";
					}
					var vip_status = "";
					if(data[i].pay_status != "1") {
						vip_status = "非VIP会员";
					} else {
						var currentTime = new Date().getTime();
						var expTime = new Date(data[i].expiration_time).getTime();
						if(currentTime <= expTime) {
							vip_status = "VIP会员/" + vip + "/到期时间" + new Date(parseInt(data[i].expiration_time)).toLocaleString().replace(/年|月/g, "-").replace(/日/g, " ");
						} else {
							vip_status = "超期会员/" + vip + "/到期时间" + new Date(parseInt(data[i].expiration_time)).toLocaleString().replace(/年|月/g, "-").replace(/日/g, " ");
						}
					}
					var thNode = document.createElement('tr');
					thNode.innerHTML = "<td nowrap='nowrap'><img src='"+data[i].headimgurl+"' style='width:60px;height:60px;'></td><td nowrap='nowrap'>"+data[i].open_id+"</td><td nowrap='nowrap'>"+data[i].user_nickname+"</td><td nowrap='nowrap'>"+user_sex+"</td><td nowrap='nowrap'>"+data[i].user_province+"</td><td>"+data[i].user_city+"</td><td>"+vip_status+"</td>";
					detailNode.appendChild(thNode);
				}
			}
			$.ajax({
				url: '/weixin/getAllWeixinUserInfo',
				type: "POST",
				data: {},
				success: function(data) {
					if (!checkJsonIsEmpty(data)) {
						createDataList(data);
					}
				},
				error: function(status, error) {
				}
			});
		</script>
	</body>